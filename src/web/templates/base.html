<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Transcription Service{% endblock %}</title>
    <link rel="stylesheet" href="/static/css/style.css">
    {% block head %}{% endblock %}
</head>
<body>
    <header class="header">
        <div class="container">
            <h1 class="logo">Transcription Service</h1>
            <nav class="nav">
                <a href="/" class="nav-link {% if active_page == 'transcribe' %}active{% endif %}">Transcribe</a>
                <a href="/history" class="nav-link {% if active_page == 'history' %}active{% endif %}">History</a>
                <a href="/api/docs" class="nav-link" target="_blank">API Docs</a>
                <button class="settings-btn" id="settings-btn" title="Settings">
                    <span class="settings-icon">&#9881;</span>
                </button>
                <button class="theme-toggle" id="theme-toggle" title="Toggle dark mode">
                    <span class="theme-icon" id="theme-icon">&#9790;</span>
                </button>
            </nav>
        </div>
    </header>

    <main class="main">
        <div class="container">
            {% block content %}{% endblock %}
        </div>
    </main>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settings-modal" hidden>
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 class="modal-title">Settings</h3>
                <button class="modal-close" id="settings-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h4>AI Provider</h4>
                    <div class="settings-status" id="ai-status"></div>

                    <div class="setting-row">
                        <label for="ai-provider">Active Provider</label>
                        <select id="ai-provider" class="setting-select">
                            <option value="ollama">Ollama (Local)</option>
                            <option value="claude">Claude (Anthropic)</option>
                            <option value="zai">z.ai</option>
                            <option value="llama">Llama.cpp (Local)</option>
                        </select>
                    </div>
                </div>

                <div class="settings-section">
                    <h4>Ollama Settings</h4>
                    <p class="setting-description">Local LLM server - requires Ollama to be running</p>
                    <div class="setting-row">
                        <label for="ollama-model">Model</label>
                        <select id="ollama-model" class="setting-select">
                            <option value="">Loading models...</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="ollama-url">Server URL</label>
                        <input type="text" id="ollama-url" class="setting-input" value="http://localhost:11434" placeholder="http://localhost:11434">
                    </div>
                </div>

                <div class="settings-section">
                    <h4>Claude Settings</h4>
                    <p class="setting-description">Anthropic Claude API</p>
                    <div class="setting-row">
                        <label for="anthropic-key">API Key</label>
                        <input type="password" id="anthropic-key" class="setting-input" placeholder="sk-ant-...">
                    </div>
                    <div class="setting-row">
                        <label for="claude-model">Model</label>
                        <select id="claude-model" class="setting-select">
                            <option value="claude-sonnet-4-20250514">Claude Sonnet 4</option>
                            <option value="claude-3-5-sonnet-20241022">Claude 3.5 Sonnet</option>
                            <option value="claude-3-haiku-20240307">Claude 3 Haiku</option>
                        </select>
                    </div>
                </div>

                <div class="settings-section">
                    <h4>z.ai Settings</h4>
                    <p class="setting-description">OpenAI-compatible API endpoint</p>
                    <div class="setting-row">
                        <label for="zai-key">API Key</label>
                        <input type="password" id="zai-key" class="setting-input" placeholder="API Key">
                    </div>
                    <div class="setting-row">
                        <label for="zai-url">Base URL</label>
                        <input type="text" id="zai-url" class="setting-input" value="https://api.z.ai/v1" placeholder="https://api.z.ai/v1">
                    </div>
                </div>

                <div class="settings-section">
                    <h4>Llama.cpp Settings</h4>
                    <p class="setting-description">Local model file (.gguf)</p>
                    <div class="setting-row">
                        <label for="llama-path">Model Path</label>
                        <input type="text" id="llama-path" class="setting-input" placeholder="/path/to/model.gguf">
                    </div>
                </div>

                <div class="settings-section">
                    <h4>Features Status</h4>
                    <p class="setting-description">Status of optional features and dependencies</p>
                    <div class="features-status-grid" id="features-status">
                        <div class="feature-status-item" id="feature-translation">
                            <span class="feature-name">Translation</span>
                            <span class="feature-indicator loading"></span>
                        </div>
                        <div class="feature-status-item" id="feature-speaker">
                            <span class="feature-name">Speaker Detection</span>
                            <span class="feature-indicator loading"></span>
                        </div>
                        <div class="feature-status-item" id="feature-semantic">
                            <span class="feature-name">Semantic Search</span>
                            <span class="feature-indicator loading"></span>
                        </div>
                    </div>
                    <div class="feature-details" id="feature-details" hidden></div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="action-btn secondary" id="settings-cancel">Cancel</button>
                <button class="action-btn" id="settings-save">Save Settings</button>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p>Powered by OpenAI Whisper</p>
        </div>
    </footer>

    <script src="/static/js/settings.js"></script>
    {% block scripts %}{% endblock %}
</body>
</html>
