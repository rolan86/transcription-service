{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="transcription-app">
    <!-- Mode Selector -->
    <div class="mode-selector">
        <button class="mode-btn active" data-mode="upload">
            <span class="icon">&#128193;</span>
            Upload File
        </button>
        <button class="mode-btn" data-mode="record">
            <span class="icon">&#127908;</span>
            Record Audio
        </button>
    </div>

    <!-- Settings Panel -->
    <div class="settings-panel">
        <div class="setting-group">
            <label for="model-select">Model</label>
            <select id="model-select">
                <option value="tiny">Tiny (Fastest)</option>
                <option value="base" selected>Base (Balanced)</option>
                <option value="small">Small (Better)</option>
                <option value="medium">Medium (High Quality)</option>
                <option value="large">Large (Best)</option>
            </select>
        </div>
        <div class="setting-group">
            <label for="language-select">Language</label>
            <select id="language-select">
                <option value="">Auto-detect</option>
                <option value="en">English</option>
                <option value="es">Spanish</option>
                <option value="fr">French</option>
                <option value="de">German</option>
                <option value="it">Italian</option>
                <option value="pt">Portuguese</option>
                <option value="ja">Japanese</option>
                <option value="ko">Korean</option>
                <option value="zh">Chinese</option>
                <option value="hi">Hindi</option>
            </select>
        </div>
        <div class="setting-group">
            <label for="format-select">Output Format</label>
            <select id="format-select">
                <option value="json" selected>JSON</option>
                <option value="txt">Plain Text</option>
                <option value="srt">SRT Subtitles</option>
                <option value="vtt">VTT Subtitles</option>
            </select>
        </div>
        <div class="setting-group checkbox-group">
            <label>
                <input type="checkbox" id="enable-speakers">
                Enable Speaker Detection
            </label>
        </div>
    </div>

    <!-- Upload Mode -->
    <div id="upload-mode" class="mode-content active">
        <div class="upload-zone" id="upload-zone">
            <div class="upload-icon">&#128194;</div>
            <p class="upload-text">Drag & drop audio/video file here</p>
            <p class="upload-subtext">or click to browse</p>
            <input type="file" id="file-input" accept=".mp3,.wav,.m4a,.flac,.mp4,.mov,.avi" hidden>
            <p class="supported-formats">Supported: MP3, WAV, M4A, FLAC, MP4, MOV, AVI</p>
        </div>
        <div class="file-info" id="file-info" hidden>
            <span class="file-name"></span>
            <button class="remove-file" id="remove-file">&times;</button>
        </div>
        <button class="transcribe-btn" id="transcribe-btn" disabled>
            Transcribe
        </button>
    </div>

    <!-- Record Mode -->
    <div id="record-mode" class="mode-content">
        <div class="record-controls">
            <button class="record-btn" id="record-btn">
                <span class="record-icon"></span>
                <span class="record-text">Start Recording</span>
            </button>
            <div class="record-timer" id="record-timer">00:00</div>
        </div>
        <div class="audio-level" id="audio-level">
            <div class="level-bar"></div>
        </div>
        <p class="record-hint">Click to start recording from your microphone</p>

        <!-- Recording Actions (shown after recording stops) -->
        <div class="recording-actions" id="recording-actions" hidden>
            <button class="action-btn" id="download-audio-btn">Download Audio</button>
            <button class="action-btn secondary" id="new-recording-btn">New Recording</button>
        </div>
    </div>

    <!-- Progress -->
    <div class="progress-container" id="progress-container" hidden>
        <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
        </div>
        <p class="progress-text" id="progress-text">Processing...</p>
    </div>

    <!-- Results -->
    <div class="results-container" id="results-container" hidden>
        <div class="results-header">
            <h2>Transcription Result</h2>
            <div class="results-meta">
                <span class="meta-item" id="result-language"></span>
                <span class="meta-item" id="result-confidence"></span>
                <span class="meta-item" id="result-time"></span>
            </div>
        </div>
        <div class="transcript-box" id="transcript-box">
            <pre id="transcript-text"></pre>
        </div>
        <div class="results-actions">
            <button class="action-btn" id="copy-btn">Copy Text</button>
            <button class="action-btn" id="download-btn">Download</button>
            <button class="action-btn secondary" id="new-transcription-btn">New Transcription</button>
        </div>
    </div>

    <!-- Live Transcript (for recording mode) -->
    <div class="live-transcript" id="live-transcript" hidden>
        <h3>Live Transcript</h3>
        <div class="live-text" id="live-text"></div>
    </div>

    <!-- Error Display -->
    <div class="error-container" id="error-container" hidden>
        <div class="error-message" id="error-message"></div>
        <button class="action-btn secondary" id="error-dismiss">Dismiss</button>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/main.js"></script>
<script src="/static/js/uploader.js"></script>
<script src="/static/js/recorder.js"></script>
<script src="/static/js/websocket.js"></script>
{% endblock %}
